var $width=jQuery(window).width(),ua=window.navigator.userAgent,device={detect:{isie:ua.indexOf("NET "),phone:$width<768}},calendar_settings,dwh_calendar=function(e){function t(){s={booking:e("#booking"),ctabutton:e(".ctabutton"),arrival:e("input[name=arrival]"),departure:e("input[name=departure]"),promocode:e("input[name=promo_code]"),hotelselect:e("#select-hotel"),moclink:e(".ctamodify"),hotelid:e("input[name=hotelid]")},a()}function a(){_date=new Date,r(),i(_date),u(),p(),n(),o()}function o(){_pattern=/^[A-Z0-9]+$/i,_countsplchr=0,e(document).on("keyup","input[name=promo_code]",function(){_value=s.promocode.val(),""==_value||_pattern.test(_value)?(s.promocode.css("border","1px solid #ccc"),_countsplchr=0):(s.promocode.css("border","1px solid red"),_countsplchr++),1===_countsplchr?(s.promocode.after('<span id="promocode_validation_notification" style="position:absolute; z-index: 100; bottom: -18px; left: 0; display: block; padding: 3px 0; font-size: 0.8em; color: red; background: #fcfcfc; text-align:center; width: 100%;">Invalid Code</span>'),s.ctabutton.addClass("invalid")):0===_countsplchr&&(e("#promocode_validation_notification").remove(),s.ctabutton.removeClass("invalid"))})}function n(){e("body").on("click",".ctabutton",function(e){site_info.is_corpsite>0&&"select"==s.hotelselect.val()&&(e.preventDefault(),alert("Please Select a Property")),s.ctabutton.hasClass("invalid")&&(e.preventDefault(),alert("Invalid Promocode"))})}function i(t){_nextday=t.getTime()+864e5,_mindate=new Date(_nextday),s.arrival.datepicker("setDate",e.datepicker.formatDate("dd M yy",new Date(t))),s.arrival.datepicker("hide"),s.departure.datepicker("option","minDate",_mindate),s.departure.datepicker("setDate",e.datepicker.formatDate("dd M yy",new Date(_nextday))),l()}function r(){s.arrival.datepicker({dateFormat:"dd M yy",showOn:"both",buttonImageOnly:!1,buttonText:"",constrainInput:!0,changeMonth:!0,changeYear:!0,showTime:!1,showHour:!1,showMinute:!1,showSecond:!1,yearRange:"0:+1",minDate:0,onSelect:c,onClose:function(e,t){device.detect.isie&&(this.fixFocusIE=!0),this.focus()},beforeShow:function(e,t){if(device.detect.isie){var a=!this.fixFocusIE;return this.fixFocusIE=!1,a}}}),s.departure.datepicker({dateFormat:"dd M yy",showOn:"both",buttonImageOnly:!1,buttonText:"",constrainInput:!0,changeMonth:!0,changeYear:!0,showTime:!1,showHour:!1,showMinute:!1,showSecond:!1,yearRange:"0:+1",defaultDate:1,minDate:0,onSelect:d,onClose:function(e,t){device.detect.isie&&(this.fixFocusIE=!0),this.focus()},beforeShow:function(e,t){if(device.detect.isie){var a=!this.fixFocusIE;return this.fixFocusIE=!1,a}}})}function d(){_date=s.departure.datepicker("getDate"),s.departure.datepicker("setDate",e.datepicker.formatDate("dd M yy",new Date(_date))),s.departure.datepicker("hide"),l()}function c(){_date=s.arrival.datepicker("getDate"),_nextday=_date.getTime()+864e5,_mindate=new Date(_nextday),s.arrival.datepicker("setDate",e.datepicker.formatDate("dd M yy",new Date(_date))),s.arrival.datepicker("hide"),s.departure.datepicker("option","minDate",_mindate),s.departure.datepicker("setDate",e.datepicker.formatDate("dd M yy",new Date(_nextday))),l()}function l(){arrivaldate=e.datepicker.parseDate(e.datepicker._defaults.dateFormat,e.datepicker.formatDate("mm/dd/yy",new Date(s.arrival.val()))),departuredate=e.datepicker.parseDate(e.datepicker._defaults.dateFormat,e.datepicker.formatDate("mm/dd/yy",new Date(s.departure.val()))),site_info.is_corpsite>0?hotelid=s.hotelselect.val():hotelid=hotel_info.hotel_id,s.arrival.length>0&&s.departure.length>0?(""!=s.promocode.val()&&s.promocode.length>0?(booking_url=cta_link_config.nw.promocode.base_url,booking_url+=hotelid+"/",booking_url+=s.promocode.val()+"/"):(booking_url=cta_link_config.nw.calendar.base_url,booking_url+=hotelid+"/"),booking_url+=e.datepicker.formatDate("yy-mm-dd",new Date(arrivaldate))+"/",booking_url+=e.datepicker.formatDate("yy-mm-dd",new Date(departuredate))+"/"):(booking_url=s.hotelid.val(),booking_url+=hotelid),""!=s.promocode.val()&&s.promocode.length>0?(booking_url+=cta_link_config.nw.promocode.param1,booking_url+=cta_link_config.nw.promocode.param2,booking_url+=cta_link_config.nw.promocode.param3):s.arrival.length>0&&s.departure.length>0&&(booking_url+=cta_link_config.nw.calendar.param1,booking_url+=cta_link_config.nw.calendar.param2),moclink_url=cta_link_config.nw.moclink.base_url+hotelid+"/"+cta_link_config.nw.moclink.param1,s.moclink.attr("href",moclink_url),s.ctabutton.attr("href",booking_url)}function u(){e("body").on("keyup","input[name=promo_code]",function(){l()})}function p(){e("body").on("change","#select-hotel",function(){l()})}var s;hotel_info.hotel_id;return e(document).ready(function(){require(["jquery_ui_core","jquery_ui_datepicker"],function(){t()})}),{init:t,ui_settings:s,calendar_settings:calendar_settings,bindUIEvents:a}}(jQuery);